{"ast":null,"code":"var _jsxFileName = \"/Users/divbhasin/rails-app/app/javascript/components/Food.jsx\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Alert, Button, Col, Form, Modal, Spinner } from 'react-bootstrap';\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport paginationFactory from 'react-bootstrap-table2-paginator';\nimport ToolkitProvider, { Search } from 'react-bootstrap-table2-toolkit';\nimport DatePicker from 'react-datepicker';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport 'react-bootstrap-table2-paginator/dist/react-bootstrap-table2-paginator.min.css';\nimport 'react-bootstrap-table2-toolkit/dist/react-bootstrap-table2-toolkit.min.css';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport './Food.css';\n\nvar NoDataIndication = function NoDataIndication() {\n  return React.createElement(\"div\", {\n    className: \"spinner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    animation: \"border\",\n    role: \"status\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"sr-only\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 17\n    },\n    __self: this\n  }, \"Loading...\")));\n};\n\nvar SearchBar = Search.SearchBar;\n\nvar Food =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Food, _Component);\n\n  function Food(props) {\n    var _this;\n\n    _classCallCheck(this, Food);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Food).call(this, props));\n\n    _this.getFoods = function () {\n      axios.get('/api/foods', {\n        withCredentials: true\n      }).then(function (_ref) {\n        var data = _ref.data;\n\n        _this.setState({\n          isLoading: false,\n          data: data.foods,\n          originalData: data.foods\n        });\n      })[\"catch\"](function (error) {\n        return console.log('api errors:', error);\n      });\n    };\n\n    _this.handleDateChange = function (date) {\n      _this.setState({\n        date: date\n      });\n    };\n\n    _this.handleModalClose = function () {\n      _this.setState({\n        showModal: false\n      });\n    };\n\n    _this.handleModalExit = function () {\n      _this.setState({\n        selectedFood: {}\n      });\n    };\n\n    _this.onRowClick = function (e, food, rowIndex) {\n      _this.setState({\n        showModal: true,\n        selectedFood: food\n      });\n    };\n\n    _this.formatDate = function (d) {\n      var yyyy = d.getFullYear().toString();\n      var mm = (d.getMonth() + 1).toString();\n      var dd = d.getDate().toString();\n      return yyyy + '-' + (mm[1] ? mm : \"0\" + mm[0]) + '-' + (dd[1] ? dd : \"0\" + dd[0]);\n    };\n\n    _this.state = {\n      isLoading: true,\n      showModal: false,\n      showToast: false,\n      date: new Date(),\n      grams: 100,\n      selectedFood: {},\n      columns: [{\n        dataField: 'id',\n        text: 'ID',\n        hidden: 'true'\n      }, {\n        dataField: 'food_group_id',\n        text: 'Food group',\n        hidden: 'true'\n      }, {\n        dataField: 'name',\n        text: 'Name',\n        sort: true,\n        headerStyle: function headerStyle() {\n          return {\n            width: '480px'\n          };\n        }\n      }, {\n        dataField: 'calories',\n        text: 'Calories',\n        sort: true\n      }, {\n        dataField: 'carbs',\n        text: 'Carbs',\n        sort: true\n      }, {\n        dataField: 'protein',\n        text: 'Protein',\n        sort: true\n      }, {\n        dataField: 'fat',\n        text: 'Fat',\n        sort: true\n      }, {\n        dataField: 'fibre',\n        text: 'Fibre',\n        sort: true\n      }],\n      data: [],\n      originalData: []\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleQueryChange = _this.handleQueryChange.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Food, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.getFoods();\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      event.preventDefault();\n      var _event$target = event.target,\n          name = _event$target.name,\n          value = _event$target.value;\n      this.setState(_defineProperty({}, name, value));\n    }\n  }, {\n    key: \"handleQueryChange\",\n    value: function handleQueryChange(event) {\n      var _this2 = this;\n\n      var _event$target2 = event.target,\n          name = _event$target2.name,\n          value = _event$target2.value;\n      console.log(value);\n\n      if (!value) {\n        this.setState({\n          data: this.state.originalData\n        });\n      } else if (value.length > 3) {\n        axios.get('/api/food/search', {\n          withCredentials: true,\n          params: {\n            query: value\n          }\n        }).then(function (_ref2) {\n          var data = _ref2.data;\n\n          _this2.setState({\n            data: data.search_results\n          });\n        })[\"catch\"](function (error) {\n          return console.log('api errors:', error);\n        });\n      }\n    }\n  }, {\n    key: \"handleBlur\",\n    value: function handleBlur(event) {\n      event.preventDefault();\n      var _event$target3 = event.target,\n          name = _event$target3.name,\n          value = _event$target3.value;\n\n      if (name == 'grams' && !value) {\n        this.setState(_defineProperty({}, name, 100));\n      }\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(event) {\n      var _this3 = this;\n\n      event.preventDefault();\n      this.handleModalClose();\n      var food_history = {\n        food_id: this.state.selectedFood.id,\n        servings: this.state.grams,\n        created_at: this.formatDate(this.state.date)\n      };\n      axios.post('/api/food_histories', {\n        food_history: food_history\n      }, {\n        withCredentials: true\n      }).then(function () {\n        _this3.setState({\n          showToast: true\n        });\n\n        setTimeout(function () {\n          _this3.setState({\n            showToast: false\n          });\n        }, 3000);\n      })[\"catch\"](function (error) {\n        return console.log('api errors:', error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$state = this.state,\n          isLoading = _this$state.isLoading,\n          columns = _this$state.columns,\n          data = _this$state.data,\n          date = _this$state.date,\n          grams = _this$state.grams,\n          selectedFood = _this$state.selectedFood,\n          showModal = _this$state.showModal,\n          showToast = _this$state.showToast;\n      var _this$props = this.props,\n          checkedLogin = _this$props.checkedLogin,\n          isLoggedIn = _this$props.isLoggedIn,\n          user = _this$props.user;\n      var multFactor = grams / 100.0;\n\n      if (!checkedLogin) {\n        return null;\n      } else if (!isLoggedIn) {\n        this.props.history.push('/login');\n      }\n\n      var _noDataIndication = isLoading ? React.createElement(NoDataIndication, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }) : null;\n\n      var alert;\n\n      if (showToast) {\n        alert = React.createElement(Alert, {\n          variant: \"success\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, \"Successfully added food.\");\n      }\n\n      return React.createElement(\"div\", {\n        className: \"container secondary-color\",\n        style: {\n          marginTop: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, alert, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Form.Control, {\n        className: \"search-bar\",\n        type: \"plaintext\",\n        placeholder: \"What did you eat today?\",\n        onChange: this.handleQueryChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }), React.createElement(\"hr\", {\n        className: \"my-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }), React.createElement(BootstrapTable, {\n        bootstrap4: true,\n        keyField: \"id\",\n        data: data,\n        columns: columns,\n        hover: true,\n        striped: true,\n        noDataIndication: function noDataIndication() {\n          return _noDataIndication;\n        },\n        pagination: paginationFactory(),\n        rowEvents: {\n          onClick: this.onRowClick\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      })), React.createElement(Modal, {\n        show: showModal,\n        onHide: this.handleModalClose,\n        onExited: this.handleModalExit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(Modal.Header, {\n        closeButton: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(Modal.Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, \"Add Food\")), React.createElement(Form, {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(Modal.Body, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, \"Name:\"), \" \", selectedFood.name, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }), React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, \"Calories:\"), \" \", (selectedFood.calories * multFactor).toFixed(1), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }), React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, \"Carbs:\"), \" \", (selectedFood.carbs * multFactor).toFixed(1), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }), React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"Protein:\"), \" \", (selectedFood.protein * multFactor).toFixed(1), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }), React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, \"Fat:\"), \" \", (selectedFood.fat * multFactor).toFixed(1), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }), React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, \"Fibre:\"), \" \", (selectedFood.fibre * multFactor).toFixed(1), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      })), React.createElement(Form.Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"formDate\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"Date consumed\"), React.createElement(\"div\", {\n        className: \"input-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(DatePicker, {\n        style: {\n          width: '100%'\n        },\n        className: \"form-control\",\n        selected: date,\n        onChange: function onChange(date) {\n          return _this4.handleDateChange(date);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }))), React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"formAmount\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, \"Amount consumed (g)\"), React.createElement(Form.Control, {\n        name: \"grams\",\n        type: \"number\",\n        value: grams,\n        min: \"1\",\n        onChange: this.handleChange,\n        onBlur: this.handleBlur,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      })))), React.createElement(Modal.Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"secondary\",\n        onClick: this.handleModalClose,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, \"Cancel\"), React.createElement(Button, {\n        variant: \"primary\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, \"Add Food\")))));\n    }\n  }]);\n\n  return Food;\n}(Component);\n\nexport default Food;","map":{"version":3,"sources":["/Users/divbhasin/rails-app/app/javascript/components/Food.jsx"],"names":["React","Component","axios","Alert","Button","Col","Form","Modal","Spinner","BootstrapTable","paginationFactory","ToolkitProvider","Search","DatePicker","NoDataIndication","SearchBar","Food","props","getFoods","get","withCredentials","then","data","setState","isLoading","foods","originalData","error","console","log","handleDateChange","date","handleModalClose","showModal","handleModalExit","selectedFood","onRowClick","e","food","rowIndex","formatDate","d","yyyy","getFullYear","toString","mm","getMonth","dd","getDate","state","showToast","Date","grams","columns","dataField","text","hidden","sort","headerStyle","width","handleChange","bind","handleQueryChange","handleSubmit","handleBlur","event","preventDefault","target","name","value","length","params","query","search_results","food_history","food_id","id","servings","created_at","post","setTimeout","checkedLogin","isLoggedIn","user","multFactor","history","push","noDataIndication","alert","marginTop","onClick","calories","toFixed","carbs","protein","fat","fibre"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { Alert, Button, Col, Form, Modal, Spinner } from 'react-bootstrap';\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport paginationFactory from 'react-bootstrap-table2-paginator';\nimport ToolkitProvider, { Search } from 'react-bootstrap-table2-toolkit';\nimport DatePicker from 'react-datepicker';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport 'react-bootstrap-table2-paginator/dist/react-bootstrap-table2-paginator.min.css';\nimport 'react-bootstrap-table2-toolkit/dist/react-bootstrap-table2-toolkit.min.css';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport './Food.css';\n\nconst NoDataIndication = () => (\n  <div className=\"spinner\">\n    <Spinner animation=\"border\" role=\"status\">\n      <span className=\"sr-only\">Loading...</span>\n    </Spinner>\n  </div>\n);\n\nconst { SearchBar } = Search;\n\nclass Food extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      showModal: false,\n      showToast: false,\n      date: new Date(),\n      grams: 100,\n      selectedFood: {},\n      columns: [{\n        dataField: 'id',\n        text: 'ID',\n        hidden: 'true'\n      },\n      {\n        dataField: 'food_group_id',\n        text: 'Food group',\n        hidden: 'true'\n      },\n      {\n        dataField: 'name',\n        text: 'Name',\n        sort: true, \n        headerStyle: () => {\n          return { width: '480px' };\n        }\n      },\n      {\n        dataField: 'calories',\n        text: 'Calories',\n        sort: true\n      },\n      {\n        dataField: 'carbs',\n        text: 'Carbs',\n        sort: true\n      },\n      {\n        dataField: 'protein',\n        text: 'Protein',\n        sort: true\n      },\n      {\n        dataField: 'fat',\n        text: 'Fat',\n        sort: true\n      },\n      {\n        dataField: 'fibre',\n        text: 'Fibre',\n        sort: true\n      }],\n      data: [],\n      originalData: []\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleQueryChange = this.handleQueryChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleBlur = this.handleBlur.bind(this);\n  }\n\n  componentWillMount() {\n    this.getFoods();\n  }\n\n  getFoods = () => {\n    axios.get('/api/foods', { withCredentials: true })\n      .then(({ data }) => {\n        this.setState({\n          isLoading: false,\n          data: data.foods,\n          originalData: data.foods\n        });\n      })\n      .catch(error => console.log('api errors:', error))\n  }\n\n  handleChange(event) {\n    event.preventDefault();\n    const { name, value } = event.target;\n    this.setState({ [name]: value });\n  }\n\n  handleQueryChange(event) {\n    const { name, value } = event.target;\n    console.log(value);\n\n    if (!value) {\n      this.setState({ data: this.state.originalData });\n    } else if (value.length > 3) {\n      axios.get('/api/food/search', { withCredentials: true, params: { query: value } }, )\n      .then(({ data }) => {\n        this.setState({ data: data.search_results });\n      })\n      .catch(error => console.log('api errors:', error))\n    }\n  }\n\n  handleBlur(event) {\n    event.preventDefault();\n    const { name, value } = event.target;\n    if (name == 'grams' && !value) {\n      this.setState({ [name]: 100 });\n    }\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    this.handleModalClose();\n    let food_history = { food_id: this.state.selectedFood.id,\n      servings: this.state.grams, created_at: this.formatDate(this.state.date)};\n    \n    axios.post('/api/food_histories', { food_history }, { withCredentials: true })\n      .then(() => {\n        this.setState({ showToast: true })\n        setTimeout(() => {\n          this.setState({ showToast: false });\n        }, 3000);\n      })\n      .catch(error => console.log('api errors:', error))\n   }\n\n  handleDateChange = (date) => {\n    this.setState({\n      date: date\n    });\n  }\n\n  handleModalClose = () => {\n    this.setState({\n      showModal: false\n    });\n  }\n\n  handleModalExit = () => {\n    this.setState({\n      selectedFood: {}\n    });\n  }\n\n  onRowClick = (e, food, rowIndex) => {\n    this.setState({\n      showModal: true,\n      selectedFood: food\n    });\n  }\n\n  formatDate = (d) => {\n    var yyyy = d.getFullYear().toString();\n    var mm = (d.getMonth() + 1).toString();       \n    var dd = d.getDate().toString();\n    return yyyy + '-' + (mm[1] ? mm : \"0\" + mm[0]) + '-' + (dd[1] ? dd : \"0\" + dd[0]);\n  };\n\n  render() {\n    const { isLoading, columns, data, date, grams, selectedFood, showModal, showToast } = this.state;\n    const { checkedLogin, isLoggedIn, user } = this.props;\n    const multFactor = grams / 100.0;\n\n    if (!checkedLogin) {\n      return null;\n    } else if (!isLoggedIn) {\n      this.props.history.push('/login');\n    }\n\n    const noDataIndication = isLoading ? <NoDataIndication /> : null;\n    let alert;\n\n    if (showToast) {\n      alert = <Alert variant='success'>Successfully added food.</Alert>;\n    }\n  \n    return (\n      <div className=\"container secondary-color\" style={{ marginTop: 50 }}>\n        {alert}\n        <div>\n          <Form.Control className=\"search-bar\" type=\"plaintext\" placeholder=\"What did you eat today?\" onChange={this.handleQueryChange}/>\n          \n          <hr className=\"my-4\" />\n\n          <BootstrapTable\n            bootstrap4\n            keyField='id'\n            data={data}\n            columns={columns}\n            hover\n            striped\n            noDataIndication={() => noDataIndication}\n            pagination={paginationFactory()}\n            rowEvents={{onClick: this.onRowClick}}\n          />\n        </div>\n        <Modal show={showModal} onHide={this.handleModalClose} onExited={this.handleModalExit}>\n          <Modal.Header closeButton>\n            <Modal.Title>Add Food</Modal.Title>\n          </Modal.Header>\n          <Form onSubmit={this.handleSubmit}>\n            <Modal.Body>\n              <p>\n                <b>Name:</b> {selectedFood.name}<br />\n                <b>Calories:</b> {(selectedFood.calories * multFactor).toFixed(1)}<br />\n                <b>Carbs:</b> {(selectedFood.carbs * multFactor).toFixed(1)}<br />\n                <b>Protein:</b> {(selectedFood.protein * multFactor).toFixed(1)}<br />\n                <b>Fat:</b> {(selectedFood.fat * multFactor).toFixed(1)}<br />\n                <b>Fibre:</b> {(selectedFood.fibre * multFactor).toFixed(1)}<br />\n              </p>\n              <Form.Row>\n                <Form.Group as={Col} controlId=\"formDate\">\n                  <Form.Label>Date consumed</Form.Label>\n                  <div className=\"input-group\">\n                    <DatePicker\n                      style={{ width: '100%' }}\n                      className=\"form-control\"\n                      selected={date}\n                      onChange={date => this.handleDateChange(date)} />\n                  </div>\n                </Form.Group>\n                <Form.Group as={Col} controlId=\"formAmount\">\n                  <Form.Label>Amount consumed (g)</Form.Label>\n                  <Form.Control \n                    name=\"grams\"\n                    type=\"number\"\n                    value={grams}\n                    min=\"1\"\n                    onChange={this.handleChange}\n                    onBlur={this.handleBlur} />\n                </Form.Group>\n              </Form.Row>\n            </Modal.Body>\n            <Modal.Footer>\n              <Button variant=\"secondary\" onClick={this.handleModalClose}>Cancel</Button>\n              <Button variant=\"primary\" type='submit'>Add Food</Button>\n            </Modal.Footer>\n          </Form>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nexport default Food;\n"]},"metadata":{},"sourceType":"module"}